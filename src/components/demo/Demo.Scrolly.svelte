<script>
	import Scrolly from "$components/helpers/Scrolly.svelte";
	import {onMount} from 'svelte'
	import anime from 'animejs';
	// https://blog.hubspot.com/website/css-animate-on-scroll

	let value;
	let steps = [
    `The Language Server Protocol reduces complexity by diminishing the need for each language to cater to each editor.
	`,
    `step 2`,
  ];

  onMount(() => {
		
			var animation = anime({
			targets:  '.requestBox',
			keyframes: [
				{translateX: 270},
				{rotateY: 180},
				{translateX: -27},
			],	
			delay: function(el, i) { return i * 300; },
			direction: 'normal',
			loop: false,
			autoplay: false,
			easing: 'easeInOutSine',
			duration: 4000
		});
		
	document.querySelector('.request-controls .play').onclick = animation.play;
	document.querySelector('.request-controls .pause').onclick = animation.pause;
	

});



</script>

<section id="scrolly" >

	<div class="spacer" />

	<Scrolly bind:value>
		<figure>
			<div style={{width: '100%', overflow: 'auto'}}>
				<img src='assets/demo/1stgraphwhitebg.svg' alt="imageofgraph" />
			</div>	
			<p>PLACEHOLDER</p>
		</figure>

		<figure class='sticky'>
			<div style={{width: '100%', overflow: 'auto'}} class="img-container">
				<img class="image image-1" src="assets/demo/1stgraphwhitebg.svg" alt="1">
			</div>	
		</figure>
		<!-- TODO-- fade in ON SCROLL -->
<!-- can't move the above ^ into steps because need the CSS classes to be accessible from styles -->
		{#each steps as text, i}
		<div class="step" class:active={value === i}>
		  <div class="step-content">{@html text}</div>
		</div>
	  {/each}

	  <p class="step">TRYING SOMETHING</p>
	  <div class="animation-request-container">
	  <div class="request-container">
		
			<div class="request">Request 1</div>
		<div class="request-path">
			<div class="requestBox"></div>
			<div class="client">Client</div>
		</div>
		</div>
		<div class="server">Server</div>
		<div class="request-container">
			<div class="request">Request 2</div>
		<div class="request-path">
			<div class="requestBox"></div>
		</div>
		</div>

		<div class="request-controls">
			<button class="play"> Send</button>
			<button class="pause"> Pause</button>
		</div>
	</div>
	
	</Scrolly>

	<div class="spacer" />
</section>

<style>
	.request-controls{
		margin: auto;
		margin-top: 3em;
	}

.server {
	margin-top: 1em;
	margin-left: 30em;
	padding-top: .5em;
	background-color: var(--category-cyan);
	width: 6em;
	height: 3em;
	border-radius: 20px;
	text-align: center;
	color: white;
	font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
}

.client {
	margin-left: -8em;
	margin-top: 1em;
	padding-top: .5em;
	background-color: white;
	color: var(--category-cyan);
	border: 3px solid  var(--category-cyan);
	width: 6em;
	height: 3em;
	border-radius: 20px;
	text-align: center;
	font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
}
.animation-request-container {
	margin: auto;
	padding: 2em;
}
.request {
	margin-bottom: 1em;
	/* text-decoration: var(--category-cyan)  underline;
	text-decoration-style: solid;
	text-decoration-thickness: .1em; */
	font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
}
.request-container {
	margin: auto;
	width: 50%;
	padding: 0;
}

.request-controls{
	padding: 4em;
	margin: auto;
	width: 50%;

}
.request-path	{
	height: 1em;
	width: 270px;
	background-color: white;
	margin: .5em;
	align-content: center;
	border:dashed 4px var(--color-gray-200);
	border-top-left-radius: 255px 120px;
      border-top-right-radius: 120px 225px;
      border-bottom-right-radius: 225px 120px;
      border-bottom-left-radius:120px 255px;
}

.requestBox {

  width: 0;
  height: 0;
  margin-top: -.5em;
  margin-left: -.5em;
  border-top: .75em solid transparent;
  border-bottom: .75em solid transparent;
  border-left: 1.25em solid var(--color-purple);

}
.play {
	margin-right: 1em;
	height: 2em;
    color: white; /* Background color */
    background-color: var(--color-purple); /* Text color */
    cursor: pointer;
    transition: background-color 0.3s ease;
	font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
	font-size: large;
}

.play:hover {
    color: var(--color-purple); /* Change background color on hover */
    background-color: white; /* Text color */
    border: 1px solid var(--color-purple);
}

.pause {
	margin-left: 1em;
	height: 2em;
    color: white; /* Background color */
    background-color: var(--color-purple); /* Text color */
    cursor: pointer;
    transition: background-color 0.3s ease;
	font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
	font-size: large;
}

.pause:hover {
    color: var(--color-purple); /* Change background color on hover */
    background-color: white; /* Text color */
    border: 1px solid var(--color-purple);
}

.img-container {
	background-image: url('assets/demo/2ndgraphwhitebg.svg');
	background-size: contain;
	background-repeat: no-repeat;
}


.image.image-1 {
    animation: fadeOut 3s ease-in-out forwards;
    animation-delay: 0.5s;
}

	.spacer {
		height: 25vh;
	}

	.step {
		height: 80vh;
		width: 100vw;
		background: var(--color-white);
		text-align: center;
		
	}

	.step div {
		padding: 1em;
	}

	@keyframes fadeIn {
	0% { opacity: 0; }
	100% { opacity: 1; }
	}

	@keyframes fadeOut {
	0% { opacity: 1; }
	100% { opacity: 0; }
	}
</style>
